import matplotlib.pyplot as plt
import numpy as np


def create_updated_singular_plots():
    """Создание обновленных графиков сингулярных чисел"""

    # Данные из ваших результатов
    train_sigma = [0.2910996509976015, 0.2356429845600068, 0.195692474769321, 0.1692467511915121,
                   0.12975277329201992, 0.10365874089791798, 0.09242694136046296, 0.08801425657488518,
                   0.07976806151230008, 0.07077541942680919, 0.06037115270075799, 0.05855012517324453,
                   0.038912662680720495, 0.035092732155520494, 0.03341139216900873, 0.028450760262403653,
                   0.01899665390328046, 0.01787512177628724, 0.014554899563522293, 0.008937781977673202,
                   0.001715224828842533, 2.6955244518609413e-16, 2.3018651462839466e-17,
                   1.541430479994422e-17, 5.554565164299047e-18]

    test_sigma = [1.0000000000000004, 1.0, 1.0, 0.9999999999999999, 0.9999999999999999,
                  0.9999999999999999, 0.9999999999999999, 0.9999999999999999, 0.9999999999999997,
                  0.9999999999999997, 0.9999999999999994, 0.9999999999999988, 0.9983652619362173,
                  0.9965559226721643, 0.9946066767900846, 0.9681116567861583, 0.9616343887841206,
                  0.9433510731205916, 0.9383243311851827, 0.9268145985513455, 0.8809077880830944,
                  0.8270242002849882, 0.7663449585909966, 0.742335609856113, 0.696751301418398,
                  0.6677249650422625, 0.6562373517994264, 0.579124535015147, 0.536254919231182,
                  0.46116088190107923, 0.4498914090955869, 0.38808229226444346, 0.3573513336419318,
                  0.30621471329055666, 0.25484810283300574, 0.2087356542448214, 0.18676511213853614,
                  0.12661742822769287, 0.061129927025578665, 0.05167197604802564, 0.04057822690222829,
                  0.0005314617219872975, 7.617502839589346e-16, 3.0346007037641725e-16,
                  2.32670794365791e-16, 1.4630758060105215e-16, 1.2518165258717502e-16,
                  1.0165992230408408e-16, 5.0424286868391533e-17]

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))

    # График сингулярных чисел
    ax1.plot(range(1, len(train_sigma) + 1), train_sigma, 'o-', label='Обучающие данные', linewidth=2)
    ax1.plot(range(1, len(test_sigma) + 1), test_sigma, 's-', label='Тестовые данные', linewidth=2)
    ax1.axhline(y=1.0, color='red', linestyle='--', alpha=0.7, label='Полное пересечение')
    ax1.set_xlabel('Номер компоненты')
    ax1.set_ylabel('Сингулярное число (σ)')
    ax1.set_title('Сингулярные числа подпространств')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # График в логарифмической шкале для лучшей визуализации
    ax2.semilogy(range(1, len(train_sigma) + 1), train_sigma, 'o-', label='Обучающие данные', linewidth=2)
    ax2.semilogy(range(1, len(test_sigma) + 1), test_sigma, 's-', label='Тестовые данные', linewidth=2)
    ax2.set_xlabel('Номер компоненты')
    ax2.set_ylabel('log(σ)')
    ax2.set_title('Сингулярные числа (логарифмическая шкала)')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('singular_values_comparison.png', dpi=300, bbox_inches='tight')
    plt.show()


create_updated_singular_plots()